---
title: "Benchmark Internacional - ICT Sector"
output: 
      flexdashboard::flex_dashboard:
      orientation: rows
social: menu
source_code: embed
---

```{r, message=FALSE, warning=FALSE, include=FALSE}
library(dplyr)
df = read.csv("./dataset/predict_2017_full.csv", header = TRUE, sep = ",", dec = ".", numerals = "no.loss")
int_cou = c("UK", "BR", "US", "KR", "CN")
euro_pps = "Millions of current euros PPS"
opr = "b) ICT sector (operational definition)"
sec = "A'=B'+C"
classfication = "261-264, 582, 61, 62, 631, 951"
countries = c("United Kingdom", "Brazil", "United States", "South Korea", "China")
berd_y = c(2008, 2011)
```

Business Expenditure in R&D (BERD)
=======================================================================

Row
-----------------------------------------------------------------------

### Brazil Berd analysis 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
br_berd = filter(df, countrycode == "BR", variablecode == 'BERD', unit == euro_pps, classificationcode == classfication, !is.na(value))
plot_bba = barplot(br_berd$value, main="Brazil BERD Expenditure", 
                   xlab="Years",
                   ylab="Millions of current euros",
                   names.arg = br_berd$year,
                   col = "red",
                   ylim = c(0, 2000)) 
```

### No LI effect model (NLI)

```{r}

```

Row
-----------------------------------------------------------------------

###  International Benchmark

```{r}
df_berd =  filter(df, countrycode %in% c("BR", "UK", "US", "KR", "CN"), 
                  variablecode == 'BERD', unit == euro_pps, 
                  classificationcode == classfication, year %in% c(2008, 2011), !is.na(value))

df_berd = df_berd[,-c(1,2,5,6,7,8,9,10)]
y2008 = filter(df_berd, year == 2008)
y2011 = filter(df_berd, year == 2011)
df_berd = data.frame("2008" = y2008$value, "2011" = y2011$value, row.names = countries)
df_berd = as.data.frame(t(df_berd))
df_berd_m = as.matrix(df_berd)
be_barplot = barplot(df_berd_m , beside=T, legend.text = T, col=c("blue" , "red"), ylim=c(0,70000), xlab = "Countries", 
                     ylab = "Millions of current euros",
                     main = "International BERD Expenditure Comparision")
```

### Forecast Model for NLI

```{r}

```


Gross R&D Expenditure (GERD)
=======================================================================

```{r, echo=FALSE, message=FALSE, warning=FALSE}
int_cou = c("UK", "BR", "US", "KR", "CN")
euro_pps = "Millions of current euros PPS"
euro_lab = "Millions of current euros"
opr = "b) ICT sector (operational definition)"
sec = "A'=B'+C"
classfication = "261-264, 582, 61, 62, 631, 951"
countries = c("United Kingdom", "Brazil", "United States", "South Korea", "China")
berd_y = c(2008, 2011)

gerd_df = filter(df, variablecode == "BERD", 
                  countrycode %in% c("BR", "UK", "US", "KR", "CN"), 
                  sectorcode == 'GERD', unit == euro_pps)

### International Benchmark
int_gerd = gerd_df
int_gerd = filter(int_gerd, year %in% c(2000:2013))
### uk tseries
uk_ts_gerd = filter(int_gerd, countrycode == "UK")
uk_ts_gerd = uk_ts_gerd$value
### us tseries
us_ts_gerd = filter(int_gerd, countrycode == "US")
us_ts_gerd = us_ts_gerd$value
### kr tseries
kr_ts_gerd = filter(int_gerd, countrycode == "KR")
kr_ts_gerd = kr_ts_gerd$value
### cn tseries
cn_ts_gerd = filter(int_gerd, countrycode == "CN")
cn_ts_gerd = cn_ts_gerd$value
```


Row
-----------------------------------------------------------------------

### Brazil GERD analysis 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
br_gerd = filter(gerd_df, countrycode == "BR", !is.na(value))
ts_gerd = br_gerd$value
ts_year = br_gerd$year
plot_gebr = plot(ts_year, ts_gerd, type = 'l', col = "red",
                main = "Brazilian GERD Expenditures", ylab = euro_lab, xlab = "Years", ylim = c(10000, 30000), xlim = c(2000, 2013))
```

### International GERD analysis 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
color = c("blue", "red", "black", "orange", "brown")
types = c('l', "b", "l", "o", "b")

plot_geint = plot(ts_year, ts_gerd, type = 'l', col = "red",
                  main = "International GERD Expenditures", ylab = euro_lab, xlab = "Years", ylim = c(10000, 400000), xlim = c(2000, 2013))
lines(ts_year, uk_ts_gerd, type = 'b', col = "blue")
lines(ts_year, us_ts_gerd, type = 'l', col = "black")
lines(ts_year, kr_ts_gerd, type = 'o', col = "orange")
lines(ts_year, cn_ts_gerd, type = 'b', col = "brown")
legend("topleft", countries, col = color, pch = c(1,1,1,1,1))
```

Row
-----------------------------------------------------------------------

###  International Benchmark

```{r, echo=FALSE, message=FALSE, warning=FALSE}
boxp_gerd_int = boxplot(uk_ts_gerd, ts_gerd, us_ts_gerd, kr_ts_gerd, cn_ts_gerd, names = countries, main = "International GERD Comparision", ylab = euro_lab)
```

### International Benchmark

```{r, echo=FALSE, message=FALSE, warning=FALSE}
slices_gerd = c(30805, 29302, 337256, 50223, 246144)
pct = round(slices_gerd/sum(slices_gerd)*100)
countries_pie = paste(countries, pct) # add percents to labels
countries_pie = paste(countries_pie,"%",sep="") # ad % to labels
pie_gerd = pie(slices_gerd,labels = countries_pie, main="International GERD Expenditures - 2013") 
```


 R&D personnel (PERD)
=======================================================================

```{r, message=FALSE, warning=FALSE, include=FALSE}
int_cou = c("UK", "BR", "US", "KR", "CN")
euro_lab = "Millions of current euros"
sec_perd = "A=B+SER"
classfication = "261-264, 582, 61, 62, 631, 951"
countries_perd = c("United Kingdom", "Brazil", "China", "South Korea")
countries_rerd = c("United Kingdom", "Brazil", "United States", "South Korea", "China")

perd_df = filter(df, variablecode == "PERD", 
                 countrycode %in% c("BR", "UK", "US", "KR", "CN"), sectorcode == sec,
                 year %in% c(2008, 2011), !is.na(value))

rerd_df = filter(df, variablecode == "RERD", 
                 countrycode %in% c("BR", "UK", "US", "KR", "CN"),
                 sectorcode == "TOT",
                 year %in% c(2000:2011),
                 !is.na(value))

### International Benchmark
int_rerd = rerd_df
int_rerd = filter(int_rerd, year %in% c(2000:2011))
### uk tseries
uk_ts_rerd = filter(int_rerd, countrycode == "UK")
uk_ts_rerd = uk_ts_rerd$value
### Brazil Series
br_rerd = filter(rerd_df, countrycode == "BR", !is.na(value))
ts_year_rerd = br_rerd$year
ts_rerd = br_rerd$value
### us tseries
us_ts_rerd = filter(int_rerd, countrycode == "US")
us_ts_rerd = us_ts_rerd$value
### kr tseries
kr_ts_rerd = filter(int_rerd, countrycode == "KR")
kr_ts_rerd = kr_ts_rerd$value
### cn tseries
cn_ts_rerd = filter(int_rerd, countrycode == "CN")
cn_ts_rerd = cn_ts_rerd$value
```


Row
-----------------------------------------------------------------------

### International PERD analysis 

```{r}
slices_perd = c(33352, 21706, 391214, 115595)
pct_perd <- round(slices_perd/sum(slices_perd)*100)
countries_pie_perd <- paste(countries_perd, pct_perd) # add percents to labels
countries_pie_perd <- paste(countries_pie_perd,"%",sep="") # ad % to labels
pie_perd = pie(slices_perd,labels = countries_pie_perd, main="International PERD Comparision - 2011") 
```

### Researchers (RERD)

```{r, echo=FALSE, message=FALSE, warning=FALSE}
### config plot
color = c("blue", "red", "black", "orange", "brown")
types = c('l', "b", "l", "o", "b")
plot_reint = plot(ts_year_rerd, ts_rerd, type = 'l', col = "red",
                  main = "International RERD occupations", ylab = "Researchers", xlab = "Years", ylim = c(40000, 1500000), xlim = c(2000, 2011))
lines(ts_year_rerd, uk_ts_rerd, type = 'b', col = "blue")
lines(ts_year_rerd, us_ts_rerd, type = 'l', col = "black")
lines(ts_year_rerd, kr_ts_rerd, type = 'o', col = "orange")
lines(ts_year_rerd, cn_ts_rerd, type = 'b', col = "brown")
legend("topright", countries, col = color, pch = c(1,1,1,1,1), cex = 0.7)
```

Row
-----------------------------------------------------------------------

###  Remarks

### Researchers analysis

```{r, echo=FALSE, message=FALSE, warning=FALSE}
slices_rerd = c(89043, 67427, 853000, 223513, 818811)
pct_rerd <- round(slices_rerd/sum(slices_rerd)*100)
countries_pie_rerd <- paste(countries_rerd, pct_rerd) # add percents to labels
countries_pie_rerd <- paste(countries_pie_rerd,"%",sep="") # ad % to labels
pie_rerd = pie(slices_rerd,labels = countries_pie_rerd, main="International RERD Comparision - 2011") 
```

Gross Value Added (GVA)
=======================================================================

Row
-----------------------------------------------------------------------

### Brazil PERD analysis 

```{r}

```

### No LI effect model (NLI)

```{r}

```

Row
-----------------------------------------------------------------------

###  International Benchmark

```{r}

```

### Forecast Model for NLI

```{r}

```

Gross Output (GO)
=======================================================================

Row
-----------------------------------------------------------------------

### Brazil PERD analysis 

```{r}

```

### No LI effect model (NLI)

```{r}

```

Row
-----------------------------------------------------------------------

###  International Benchmark

```{r}

```

### Forecast Model for NLI

```{r}

```

Employment (EMP)
=======================================================================

Row
-----------------------------------------------------------------------

### Brazil PERD analysis 

```{r}

```

### No LI effect model (NLI)

```{r}

```

Row
-----------------------------------------------------------------------

###  International Benchmark

```{r}

```

### Forecast Model for NLI

```{r}

```


No LI Model - Simulation
=======================================================================

Row
-----------------------------------------------------------------------

### Brazil PERD analysis 

```{r}

```

### No LI effect model (NLI)

```{r}

```

Row
-----------------------------------------------------------------------

###  International Benchmark

```{r}

```

### Forecast Model for NLI

```{r}

```



